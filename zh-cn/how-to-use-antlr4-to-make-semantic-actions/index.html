

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>How to use the semantic actions to generate the symbol tables in ANTLR4 - MartinLwx&#39;s Blog</title><meta name="Description" content="use the semantic actions to generate the symbol tables in ANTLR4"><meta property="og:url" content="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/">
  <meta property="og:site_name" content="MartinLwx&#39;s Blog">
  <meta property="og:title" content="How to use the semantic actions to generate the symbol tables in ANTLR4">
  <meta property="og:description" content="use the semantic actions to generate the symbol tables in ANTLR4">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-05-28T21:09:05+08:00">
    <meta property="article:modified_time" content="2022-05-28T21:09:05+08:00">
    <meta property="article:tag" content="Compiler">
    <meta property="article:tag" content="Course">
    <meta property="og:image" content="https://martinlwx.github.io/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://martinlwx.github.io/logo.png">
  <meta name="twitter:title" content="How to use the semantic actions to generate the symbol tables in ANTLR4">
  <meta name="twitter:description" content="use the semantic actions to generate the symbol tables in ANTLR4">
<meta name="application-name" content="MartinLwx&#39;s blog">
<meta name="apple-mobile-web-app-title" content="MartinLwx&#39;s blog">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" /><link rel="prev" href="https://martinlwx.github.io/zh-cn/boyer-moore-majority-voting-algorithm-explained/" /><link rel="next" href="https://martinlwx.github.io/zh-cn/vim-macro-101/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "How to use the semantic actions to generate the symbol tables in ANTLR4",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/"
        },"genre": "posts","keywords": "Compiler, Course","wordcount":  3055 ,
        "url": "https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/","datePublished": "2022-05-28T21:09:05+08:00","dateModified": "2022-05-28T21:09:05+08:00","license": "\u003ca rel=\"license noopener\" href=\"https://creativecommons.org/licenses/by-nc-nd/4.0/\" target=\"_blank\"\u003eCC BY-NC-ND 4.0\u003c/a\u003e","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "MartinLwx"
            },"description": "use the semantic actions to generate the symbol tables in ANTLR4"
    }
    </script></head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/zh-cn/" title="MartinLwx&#39;s Blog"><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/zh-cn/posts/"> æ‰€æœ‰æ–‡ç«  </a><a class="menu-item" href="/zh-cn/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/zh-cn/categories/"> åˆ†ç±» </a><a class="menu-item" href="https://github.com/MartinLwx" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" title="é€‰æ‹©è¯­è¨€" id="language-select-desktop" onchange="location = this.value;"><option value="/en/how-to-use-antlr4-to-make-semantic-actions/">English</option><option value="/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-select" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="åˆ‡æ¢ä¸»é¢˜">
                        <option value="light">æµ…è‰²</option>
                        <option value="dark">æ·±è‰²</option>
                        <option value="black">é»‘è‰²</option>
                        <option value="auto">è·Ÿéšç³»ç»Ÿ</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/zh-cn/" title="MartinLwx&#39;s Blog"><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/zh-cn/posts/" title="">æ‰€æœ‰æ–‡ç« </a><a class="menu-item" href="/zh-cn/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/zh-cn/categories/" title="">åˆ†ç±»</a><a class="menu-item" href="https://github.com/MartinLwx" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-select" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="åˆ‡æ¢ä¸»é¢˜">
                    <option value="light">æµ…è‰²</option>
                    <option value="dark">æ·±è‰²</option>
                    <option value="black">é»‘è‰²</option>
                    <option value="auto">è·Ÿéšç³»ç»Ÿ</option>
                </select>
            </a><a href="javascript:void(0);" class="menu-item" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" title="é€‰æ‹©è¯­è¨€" onchange="location = this.value;"><option value="/en/how-to-use-antlr4-to-make-semantic-actions/">English</option><option value="/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">ç›®å½•</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#ä»€ä¹ˆæ˜¯-semantic-actions">ä»€ä¹ˆæ˜¯ semantic actions</a></li>
    <li><a href="#ä»€ä¹ˆæ˜¯-symbol-table">ä»€ä¹ˆæ˜¯ symbol table</a></li>
    <li><a href="#å¦‚ä½•åœ¨-antlr-çš„è¯­æ³•æ–‡ä»¶é‡Œé¢æ³¨å…¥åŠ¨ä½œ">å¦‚ä½•åœ¨ ANTLR çš„è¯­æ³•æ–‡ä»¶é‡Œé¢æ³¨å…¥åŠ¨ä½œ</a>
      <ul>
        <li><a href="#åŠ¨ä½œæ³¨å…¥çš„ä½ç½®å’Œæ–¹æ³•">åŠ¨ä½œæ³¨å…¥çš„ä½ç½®å’Œæ–¹æ³•</a>
          <ul>
            <li><a href="#header"><code>&lt;header&gt;</code></a></li>
            <li><a href="#member"><code>&lt;member&gt;</code></a></li>
            <li><a href="#action"><code>&lt;action&gt;</code></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­</a>
      <ul>
        <li><a href="#æ•°æ®ç»“æ„çš„é€‰å–åŠå¯¹åº”çš„æ–¹æ³•">æ•°æ®ç»“æ„çš„é€‰å–åŠå¯¹åº”çš„æ–¹æ³•</a></li>
        <li><a href="#æ³¨å…¥åŠ¨ä½œåˆ°å˜é‡å£°æ˜ä¸­">æ³¨å…¥åŠ¨ä½œåˆ°å˜é‡å£°æ˜ä¸­</a></li>
        <li><a href="#å…³äºå˜é‡ä½œç”¨åŸŸçš„å¤„ç†">å…³äºå˜é‡ä½œç”¨åŸŸçš„å¤„ç†</a></li>
      </ul>
    </li>
    <li><a href="#æ‰©å±•é˜…è¯»">æ‰©å±•é˜…è¯»</a></li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">How to use the semantic actions to generate the symbol tables in ANTLR4</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class="author fas fa-user-circle fa-fw"></span><a href="https://github.com/MartinLwx" title="Author" target="_blank" rel="noopener noreferrer author" class="author">MartinLwx</a>
                </span>&nbsp;<span class="post-category">æ”¶å½•äº </span>&nbsp;<span class="post-category">ç±»åˆ« <a href="/zh-cn/categories/compiler/"><i class="far fa-folder fa-fw"></i>Compiler</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-05-28">2022-05-28</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2022-05-28">2022-05-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 3055 å­—&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 7 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ä»€ä¹ˆæ˜¯-semantic-actions">ä»€ä¹ˆæ˜¯ semantic actions</a></li>
    <li><a href="#ä»€ä¹ˆæ˜¯-symbol-table">ä»€ä¹ˆæ˜¯ symbol table</a></li>
    <li><a href="#å¦‚ä½•åœ¨-antlr-çš„è¯­æ³•æ–‡ä»¶é‡Œé¢æ³¨å…¥åŠ¨ä½œ">å¦‚ä½•åœ¨ ANTLR çš„è¯­æ³•æ–‡ä»¶é‡Œé¢æ³¨å…¥åŠ¨ä½œ</a>
      <ul>
        <li><a href="#åŠ¨ä½œæ³¨å…¥çš„ä½ç½®å’Œæ–¹æ³•">åŠ¨ä½œæ³¨å…¥çš„ä½ç½®å’Œæ–¹æ³•</a>
          <ul>
            <li><a href="#header"><code>&lt;header&gt;</code></a></li>
            <li><a href="#member"><code>&lt;member&gt;</code></a></li>
            <li><a href="#action"><code>&lt;action&gt;</code></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­</a>
      <ul>
        <li><a href="#æ•°æ®ç»“æ„çš„é€‰å–åŠå¯¹åº”çš„æ–¹æ³•">æ•°æ®ç»“æ„çš„é€‰å–åŠå¯¹åº”çš„æ–¹æ³•</a></li>
        <li><a href="#æ³¨å…¥åŠ¨ä½œåˆ°å˜é‡å£°æ˜ä¸­">æ³¨å…¥åŠ¨ä½œåˆ°å˜é‡å£°æ˜ä¸­</a></li>
        <li><a href="#å…³äºå˜é‡ä½œç”¨åŸŸçš„å¤„ç†">å…³äºå˜é‡ä½œç”¨åŸŸçš„å¤„ç†</a></li>
      </ul>
    </li>
    <li><a href="#æ‰©å±•é˜…è¯»">æ‰©å±•é˜…è¯»</a></li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="ä»€ä¹ˆæ˜¯-semantic-actions" class="headerLink">
    <a href="#%e4%bb%80%e4%b9%88%e6%98%af-semantic-actions" class="header-mark"></a>ä»€ä¹ˆæ˜¯ semantic actions</h2><p>å½“ Parser å¤„ç†è¾“å…¥çš„ä»£ç çš„æ—¶å€™ä¸ä»…è¦åˆ¤æ–­æ˜¯å¦è¯­æ³•å’Œå¥æ³•éƒ½æ­£ç¡®ï¼Œè¿˜å¯ä»¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„æ“ä½œï¼Œè¿™äº›æ“ä½œå°±å«åš Semantic actionsã€‚<strong>å…¶å®ä¹Ÿå°±æ˜¯ä¸€æ®µä»£ç </strong>ï¼Œä¸€èˆ¬åµŒå…¥åœ¨åœ¨è¯­æ³•æ–‡ä»¶çš„è§„åˆ™é‡Œé¢ã€‚é‚£ä¹ˆ<strong>å½“ parser åº”ç”¨è¿™ä¸ªè§„åˆ™</strong>çš„æ—¶å€™å°±ä¼šæ‰§è¡Œä½ è®¾ç½®çš„è¿™æ®µä»£ç ã€‚æ¢ä¸ªè§’åº¦ç†è§£ï¼Œsemantic actions å…¶å®<strong>å°±æ˜¯â€œè§¦å‘å™¨â€</strong>ï¼Œè§¦å‘æ¡ä»¶å°±æ˜¯ parser åº”ç”¨äº†å¯¹åº”çš„è§„åˆ™ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« è¦æ¢è®¨çš„å°±æ˜¯ä¸€ä¸ªå…³äº semantic actions çš„åº”ç”¨â€”â€”å®ç°ä¸€ä¸ªç®€å•çš„ symbol tableï¼Œç”¨åˆ°çš„å·¥å…·æ˜¯ <a href="https://www.antlr.org/" target="_blank" rel="noopener noreferrer">ANTLR4</a>ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯-symbol-table" class="headerLink">
    <a href="#%e4%bb%80%e4%b9%88%e6%98%af-symbol-table" class="header-mark"></a>ä»€ä¹ˆæ˜¯ symbol table</h2><p>ç¼–è¯‘å™¨åœ¨å¤„ç†æˆ‘ä»¬çš„ä»£ç çš„æ—¶å€™ä¼šåœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª symbol tableï¼Œç”¨æ¥å­˜å‚¨ç¨‹åºé‡Œé¢<strong>æ‰€æœ‰å…³äºå˜é‡çš„ä¿¡æ¯</strong>ï¼šå˜é‡åã€æ•°æ®ç±»å‹ã€å˜é‡æ‰€å±çš„ä½œç”¨åŸŸç­‰ã€‚symbol table å¯ä»¥æ˜¯ä¸‹é¢è¿™ç§å½¢å¼ï¼š</p>
<center>
<table>
<thead>
<tr>
<th style="text-align:center">Symbol name</th>
<th style="text-align:center">Type</th>
<th style="text-align:center">Scope</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">bar</td>
<td style="text-align:center">function, double</td>
<td style="text-align:center">extern</td>
</tr>
<tr>
<td style="text-align:center">x</td>
<td style="text-align:center">double</td>
<td style="text-align:center">function parameter</td>
</tr>
<tr>
<td style="text-align:center">foo</td>
<td style="text-align:center">function, double</td>
<td style="text-align:center">global</td>
</tr>
<tr>
<td style="text-align:center">count</td>
<td style="text-align:center">int</td>
<td style="text-align:center">function parameter</td>
</tr>
<tr>
<td style="text-align:center">sum</td>
<td style="text-align:center">double</td>
<td style="text-align:center">block local</td>
</tr>
<tr>
<td style="text-align:center">i</td>
<td style="text-align:center">int</td>
<td style="text-align:center">for-loop statement</td>
</tr>
</tbody>
</table>
</center>
<h2 id="å¦‚ä½•åœ¨-antlr-çš„è¯­æ³•æ–‡ä»¶é‡Œé¢æ³¨å…¥åŠ¨ä½œ" class="headerLink">
    <a href="#%e5%a6%82%e4%bd%95%e5%9c%a8-antlr-%e7%9a%84%e8%af%ad%e6%b3%95%e6%96%87%e4%bb%b6%e9%87%8c%e9%9d%a2%e6%b3%a8%e5%85%a5%e5%8a%a8%e4%bd%9c" class="header-mark"></a>å¦‚ä½•åœ¨ ANTLR çš„è¯­æ³•æ–‡ä»¶é‡Œé¢æ³¨å…¥åŠ¨ä½œ</h2><p>ANTLR4 æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ parse generatorï¼Œæˆ‘ä»¬åªè¦ç¼–å†™å¥½è¯­æ³•æ–‡ä»¶ï¼Œå°±èƒ½è®©å®ƒå¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆ Parserï¼Œç”Ÿæˆçš„ Parser å¯ä»¥æ”¯æŒå¤šç§ç›®æ ‡è¯­è¨€ï¼Œæ¯”å¦‚æˆ‘è‡ªå·±ç”¨çš„æ˜¯ <a href="https://pypi.org/project/antlr4-python3-runtime/" target="_blank" rel="noopener noreferrer">Python</a>ï¼Œé‚£ä¹ˆæœ€åç”Ÿæˆçš„ Parser å°±æ˜¯ Python æ–‡ä»¶ã€‚</p>
<p>ANTLR4 ä¹Ÿæä¾›äº†æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥åœ¨è¯­æ³•æ–‡ä»¶é‡Œé¢æ’å…¥åŠ¨ä½œï¼Œè¿™äº›åŠ¨ä½œæœ€åéƒ½ä¼šè¢« ANTLR4 æ³¨å…¥åˆ°ç”Ÿæˆçš„ Parser æ–‡ä»¶é‡Œé¢ã€‚<strong>å› æ­¤ï¼ŒåŠ¨ä½œç”¨ä»€ä¹ˆè¯­è¨€å†™å–å†³äºä½ è¾“å‡º Parser çš„ç›®æ ‡è¯­è¨€æ˜¯ä»€ä¹ˆ</strong></p>
<blockquote>
<p><strong>âš ï¸è¿™é‡Œå‡å®šä½ å¯¹å¦‚ä½•ç¼–å†™ ANTLR4 çš„è¯­æ³•æ–‡ä»¶ï¼ˆ<code>*.g4</code>ï¼‰æœ‰åŸºæœ¬äº†è§£ï¼Œä¸ä¼šè¿›è¡Œèµ˜è¿°ï¼Œæœ¬æ–‡åªé›†ä¸­ä»‹ç»å¦‚ä½•åœ¨è¯­æ³•æ–‡ä»¶é‡Œé¢æ’å…¥åŠ¨ä½œ</strong></p>
</blockquote>
<h3 id="åŠ¨ä½œæ³¨å…¥çš„ä½ç½®å’Œæ–¹æ³•" class="headerLink">
    <a href="#%e5%8a%a8%e4%bd%9c%e6%b3%a8%e5%85%a5%e7%9a%84%e4%bd%8d%e7%bd%ae%e5%92%8c%e6%96%b9%e6%b3%95" class="header-mark"></a>åŠ¨ä½œæ³¨å…¥çš„ä½ç½®å’Œæ–¹æ³•</h3><p>ä¸‹é¢æ˜¯ç®€åŒ–çš„ç”Ÿæˆçš„ Parser æ–‡ä»¶çš„ä»£ç æ¨¡æ¿ã€‚æ€»ä½“ä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬èƒ½æ³¨å…¥çš„ä½ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">header</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">xxxParser</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>    
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">member</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">action</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢æˆ‘å¯¹æ¯ä¸ªä½ç½®çš„ä¸åŒè¯­æ³•è¿›è¡Œè¯´æ˜ï¼š</p>
<h4 id="header" class="headerLink">
    <a href="#header" class="header-mark"></a><code>&lt;header&gt;</code></h4><p>ANTLR4 æœ¬æ¥å°±æ˜¯ç”¨ Java å†™çš„ï¼Œæ‰€ä»¥å¦‚æœä½ ç”¨çš„ç›®æ ‡è¯­è¨€ä¹Ÿæ˜¯ Java çš„è¯ï¼Œè¿™ä¸ªä¼šæ¯”è¾ƒç”¨å¾—åˆ°ã€‚ä¸€èˆ¬å°±æ˜¯ç”¨æ¥æ”¾ <code>import</code> è¯­å¥çš„ã€‚å¦‚æœæ˜¯ python çš„è¯å“ªé‡Œéƒ½èƒ½ <code>import</code> å°±æ¯”è¾ƒæ²¡å·®ã€‚è¦å¾€è¿™ä¸ªä½ç½®æ³¨å…¥ä»£ç çš„æ ¼å¼å¦‚ä¸‹ï¼ˆæ”¾åœ¨ <code>*.g4</code> æ–‡ä»¶é‡Œé¢ï¼Œä¸‹åŒï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="nl">@header</span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">    everything here will go to &lt;header&gt;
</span></span></span><span class="line"><span class="cl"><span class="x"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="member" class="headerLink">
    <a href="#member" class="header-mark"></a><code>&lt;member&gt;</code></h4><p>è¿™ä¸ªæ”¾çš„å°±æ˜¯ç±»çš„æˆå‘˜ï¼Œå¯ä»¥æ˜¯å­—æ®µä¹Ÿå¯ä»¥æ˜¯æ–¹æ³•ã€‚ANTLR4 æ”¯æŒå¾€ Lexer å’Œ Parser åˆ†åˆ«æˆ–è€…åŒæ—¶æ³¨å…¥ä»£ç ã€‚è¦å¾€è¿™ä¸ªä½ç½®æ³¨å…¥ä»£ç çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="nl">@members</span><span class="w"> </span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">    everything here will go to &lt;member&gt; in xxxLexer &amp;&amp; xxxParser
</span></span></span><span class="line"><span class="cl"><span class="x"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">@Lexer</span><span class="p">::</span><span class="nl">members</span><span class="w"> </span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">    everything here will go to &lt;member&gt; in xxxLexer
</span></span></span><span class="line"><span class="cl"><span class="x"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">@Parser</span><span class="p">::</span><span class="nl">members</span><span class="w"> </span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">    everything here will go to &lt;member&gt; in xxxParser
</span></span></span><span class="line"><span class="cl"><span class="x"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>âš ï¸åœ¨æˆ‘ä½¿ç”¨çš„ <code>antlr4-python3-runtime</code> ä¸­ï¼ˆ4.10ï¼‰ï¼Œè¿˜æ— æ³•åœ¨æ’å…¥ç±»çš„å­—æ®µè¿›è¡Œæ³¨é‡Š</p>
</blockquote>
<h4 id="action" class="headerLink">
    <a href="#action" class="header-mark"></a><code>&lt;action&gt;</code></h4><p>åœ¨ ANTLR4 ä¸­ï¼ŒåŠ¨ä½œæ˜¯ç”¨<strong>èŠ±æ‹¬å· <code>{&lt;specific-language-here&gt;}</code> æ‹¬èµ·æ¥çš„ä»£ç </strong>ã€‚æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œçœ‹ä½ æœ€åè¾“å‡ºçš„ Parser æƒ³è¦æ˜¯ä»€ä¹ˆè¯­è¨€ï¼Œä½ å°±ç”¨ä»€ä¹ˆè¯­è¨€å†™åŠ¨ä½œã€‚</p>
<p>åŠ¨ä½œä¸€èˆ¬ä¼šæ”¾åœ¨ä¸€æ¡è§„åˆ™çš„æŸä¸ª symbol ä¹‹åï¼Œæ„æ€æ˜¯è¯´åœ¨ parser åº”ç”¨è¿™æ¡è§„åˆ™çš„æ—¶å€™æ‰§è¡Œåˆ°è¿™é‡Œå°±æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œã€‚è¿™é‡Œçš„ symbol å¯ä»¥æ˜¯ terminal ä¹Ÿå¯ä»¥æ˜¯ nonterminalã€‚</p>
<p><strong>æˆ‘ä»¬å¯ä»¥ç”¨ <code>$symbol.attr</code> çš„æ–¹å¼è®¿é—®åˆ°å¯¹åº”çš„å±æ€§</strong>ï¼Œæœ‰ä¸‹é¢è¿™å‡ ä¸ªï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">text</span>           <span class="c1"># origin text</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">type</span>           <span class="c1"># an integer stands for type</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">attributes</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">line</span>           <span class="c1"># the line number</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">pos</span>            <span class="c1"># the position of the first char in the lineï¼Œ0-based</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">index</span>          
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">channel</span>        <span class="c1"># the channel of this terminal, won&#39;t discuss in this post</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">terminal</span><span class="o">.</span><span class="n">int</span>            <span class="c1"># return an interger if this terminal is an integer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">nonterminal</span><span class="o">.</span><span class="n">text</span>            <span class="c1"># origin text</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">nonterminal</span><span class="o">.</span><span class="n">start</span>           <span class="c1"># 1st Token</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">nonterminal</span><span class="o">.</span><span class="n">stop</span>            <span class="c1"># last Token</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="n">nonterminal</span><span class="o">.</span><span class="n">ctx</span>             <span class="c1"># return context object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¸¾ä¸ªä¾‹å­" class="headerLink">
    <a href="#%e4%b8%be%e4%b8%aa%e4%be%8b%e5%ad%90" class="header-mark"></a>ä¸¾ä¸ªä¾‹å­</h2><blockquote>
<p><strong>âš ï¸ä¸‹é¢éƒ½åªä¼šç»™å‡ºéƒ¨åˆ†ä»£ç ï¼Œå®Œæ•´çš„ä»£ç åœ¨æˆ‘çš„ <a href="https://github.com/MartinLwx/ECE573-Fall-2015-Purdue/blob/main/Project03.Symbol_table/Micro.g4" target="_blank" rel="noopener noreferrer">Github é¡¹ç›®</a></strong></p>
</blockquote>
<blockquote>
<p>âš ï¸å› ä¸ºè¿™ä¸ªé¡¹ç›®è¦æ±‚æŠŠ warning è¾“å‡ºåœ¨å…¶ä»–è¾“å‡ºå‰é¢ï¼Œæ‰€ä»¥æˆ‘ç”¨ <code>warning_list</code> å’Œ <code>output_list</code> æ¥å­˜å‚¨ï¼Œæœ€åå†ä¸€èµ·è¾“å‡º</p>
</blockquote>
<p>ä¸‹é¢ä»¥æ™®æ¸¡å¤§å­¦ 2015 å¹´çš„å¼€è®¾çš„ç¼–è¯‘å™¨è¯¾ç¨‹çš„<a href="https://engineering.purdue.edu/~milind/ece573/2015fall/project/step3/step3.html" target="_blank" rel="noopener noreferrer">é¡¹ç›®ä½œä¸š</a>ä¸ºä¾‹ï¼Œæ•´ä¸ªé¡¹ç›®è¦å®ç°ä¸€ä¸ª Micro è¯­è¨€çš„ç¼–è¯‘å™¨ï¼Œå…³äº Micro è¯­è¨€çš„è¯­æ³•ï¼Œå¯ä»¥åœ¨<a href="https://engineering.purdue.edu/~milind/ece573/2015fall/project/grammar.txt" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>çœ‹åˆ°ã€‚ä¸‹é¢æˆ‘ä¼šå¯¹æ­¥éª¤ä¸‰çš„ä½œä¸šè¦æ±‚è¿›è¡Œä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚</p>
<p>åœ¨è¿™ä¸ªä½œä¸šä¸­æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ª symbol tableï¼Œå¹¶åœ¨ç›¸åº”çš„æ—¶åˆ»è¾“å‡ºç›¸å…³çš„ä¿¡æ¯ï¼š</p>
<ul>
<li>æ¯å½“æˆ‘ä»¬è¿›å…¥ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸä¹‹å‰ï¼ˆå¯ä»¥æ˜¯å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£ç å—ï¼‰ï¼Œè¦è¿›è¡Œç›¸å…³çš„è¾“å‡º</li>
<li>å¦‚æœé‡åˆ°å˜é‡å£°æ˜ï¼Œå°±è¾“å‡ºå˜é‡åå’Œå˜é‡ç±»å‹ï¼Œæœ‰å€¼çš„è¯ä¹Ÿè¦è¾“å‡ºã€‚</li>
<li>å¦‚æœå£°æ˜çš„å˜é‡åœ¨<strong>å¤–éƒ¨ä½œç”¨åŸŸ</strong>å·²ç»å£°æ˜è¿‡çš„è¯è¦è¾“å‡ºï¼š<code>SHADOW WARNING &lt;var_name&gt;</code>ï¼Œé€‚ç”¨äºæœ‰åµŒå¥—çš„ä½œç”¨åŸŸå‡ºç°çš„æƒ…å†µ</li>
<li>å¦‚æœåœ¨<strong>å½“å‰ä½œç”¨åŸŸ</strong>å·²ç»æœ‰åŒåçš„å˜é‡ï¼Œå°±è¦è¾“å‡ºï¼š<code>DECLARATION ERROR &lt;var_name&gt;</code>ã€‚å¦‚æœå‡ºç°äº†è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆæœ€åç¨‹åºåªè¾“å‡ºè¿™ä¸ªä¿¡æ¯</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">Symbol</span> <span class="n">table</span> <span class="o">&lt;</span><span class="n">scope_name</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="o">&lt;</span><span class="n">var_name</span><span class="o">&gt;</span> <span class="n">type</span> <span class="o">&lt;</span><span class="n">type_name</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="o">&lt;</span><span class="n">var_name</span><span class="o">&gt;</span> <span class="n">type</span> <span class="o">&lt;</span><span class="n">type_name</span><span class="o">&gt;</span> <span class="n">value</span> <span class="o">&lt;</span><span class="n">string_value</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ•°æ®ç»“æ„çš„é€‰å–åŠå¯¹åº”çš„æ–¹æ³•" class="headerLink">
    <a href="#%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e7%9a%84%e9%80%89%e5%8f%96%e5%8f%8a%e5%af%b9%e5%ba%94%e7%9a%84%e6%96%b9%e6%b3%95" class="header-mark"></a>æ•°æ®ç»“æ„çš„é€‰å–åŠå¯¹åº”çš„æ–¹æ³•</h3><p>ğŸ¤”å…ˆè¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œè¦ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„è¡¨ç¤º symbol tableï¼Ÿä¸€ä¸ª symbol table åº”è¯¥è¦æ»¡è¶³ä¸‹é¢çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>è¦èƒ½å¤Ÿæ”¯æŒé«˜æ•ˆç‡åœ°æŸ¥è¯¢</li>
<li>è¦èƒ½å¤Ÿæ”¯æŒé«˜æ•ˆç‡åœ°æ’å…¥ï¼Œå› ä¸ºç¨‹åºä¸­å¯èƒ½åŒ…å«å¤§é‡çš„å˜é‡å£°æ˜</li>
<li>è¦èƒ½å¤Ÿè®°å½•å˜é‡çš„ä½œç”¨åŸŸ</li>
</ul>
<p>ä¸éš¾æƒ³å‡ºï¼Œ<strong>æ”¯æŒé«˜æ•ˆç‡æŸ¥è¯¢å’Œæ’å…¥çš„æ•°æ®ç»“æ„å°±æ˜¯ã€Œå“ˆå¸Œè¡¨ã€</strong>ã€‚ä¸ºäº†ç»´æŠ¤å˜é‡çš„ä½œç”¨åŸŸï¼Œ<strong>å¯ä»¥æŠŠåŒä¸ªä½œç”¨åŸŸä¸‹çš„å˜é‡æ”¾åœ¨åŒä¸ªå“ˆå¸Œè¡¨é‡Œé¢ï¼Œç”¨ä¸€ä¸ªåˆ—è¡¨æ¥è®°ä½æ‰€æœ‰çš„å˜é‡ä½œç”¨åŸŸ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯ <code>[{scope1}, {scope2},...]</code> è¿™æ ·ã€‚åŒæ—¶ç»´æŠ¤ä¸€ä¸ª <code>self.current_scope</code> æ¥è®°ä½å½“å‰å¤„äºå“ªä¸€ä¸ªå˜é‡ä½œç”¨åŸŸé‡Œé¢ã€‚æ¯å½“æœ‰ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸå‡ºç°çš„æ—¶å€™ï¼Œä¿å­˜å½“å‰çš„ä½œç”¨åŸŸï¼Œå¾€åˆ—è¡¨é‡Œæ’å…¥ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œå†æ›´æ–° <code>self.current_scope</code>ã€‚</p>
<blockquote>
<p>ğŸ“’ è¿™é‡Œçš„ list å…¶å®å°±æ˜¯ç”¨æ¥æ¨¡æ‹Ÿæ ˆ</p>
</blockquote>
<p>ğŸ¤”æˆ‘ä»¬è¦å®ç°ä»€ä¹ˆæ ·çš„æ–¹æ³•ï¼Ÿèµ·ç è¦æœ‰ä¸‹é¢è¿™å‡ ä¸ªï¼š</p>
<ul>
<li><code>lookup(identifier, value)</code>ï¼šæ’å…¥å˜é‡åˆ°å½“å‰çš„ symbol table é‡Œé¢ã€‚æ ¹æ®è¿™ä¸ªé¡¹ç›®ä½œä¸šçš„è¦æ±‚ï¼Œè¿˜åº”è¯¥æŸ¥è¯¢æ˜¯å¦å˜é‡å·²ç»è¢«å£°æ˜è¿‡</li>
<li><code>enter_new_scope()</code>ï¼šä¿å­˜å½“å‰çš„ symbol tableï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå˜é‡ä½œç”¨åŸŸå¹¶åˆå§‹åŒ–ä¸ºç©º</li>
<li><code>exit_scope()</code>ï¼šæ¸…ç©ºå½“å‰çš„ symbol tableï¼Œæ‰¾åˆ°ä¸Šä¸€ä¸ª symbol table</li>
</ul>
<p>æ‰€ä»¥å¯¹åº” <code>@parser:members</code> é‡Œé¢çš„ä»£ç å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@parser</span><span class="p">::</span><span class="n">members</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">current_scope</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">block_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">warning_list</span> <span class="o">=</span> <span class="p">[]</span>                    <span class="c1"># just for printing</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">output_list</span> <span class="o">=</span> <span class="p">[]</span>                      <span class="c1"># just for printing</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">declaration_error</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">enter_new_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_scopes&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_scopes&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># save the current_scope</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">copy</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_scope</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">current_scope</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">exit_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">current_scope</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># check all scopes</span>
</span></span><span class="line"><span class="cl">    <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">scope</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print(f&#34;the scope: {scope}&#34;)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">warning_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;SHADOW WARNING </span><span class="si">{</span><span class="n">identifier</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># only record the 1st declaration error</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_scope</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">declaration_error</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">declaration_error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;DECLARATION ERROR </span><span class="si">{</span><span class="n">identifier</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">current_scope</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ³¨å…¥åŠ¨ä½œåˆ°å˜é‡å£°æ˜ä¸­" class="headerLink">
    <a href="#%e6%b3%a8%e5%85%a5%e5%8a%a8%e4%bd%9c%e5%88%b0%e5%8f%98%e9%87%8f%e5%a3%b0%e6%98%8e%e4%b8%ad" class="header-mark"></a>æ³¨å…¥åŠ¨ä½œåˆ°å˜é‡å£°æ˜ä¸­</h3><p>ğŸ§æ¥ä¸‹æ¥å°±æ˜¯è¦åœ¨å¯¹åº”çš„è¯­æ³•è§„åˆ™é‡Œé¢æ³¨å…¥åŠ¨ä½œã€‚æˆ‘ä»¬æƒ³è¦åœ¨å®šä¹‰å˜é‡çš„æ—¶å€™è¾“å‡ºç›¸å…³çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¦è§‚å¯Ÿåœ¨ Micro è¯­è¨€ä¸­å˜é‡å£°æ˜çš„è§„åˆ™æ˜¯æ€ä¹ˆæ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="err">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">var_decl</span><span class="w">    </span><span class="p">:</span><span class="w">   </span><span class="nv">var_type</span><span class="w"> </span><span class="nv">id_list</span><span class="w"> </span><span class="s">&#39;;&#39;</span><span class="w">  </span><span class="p">;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">var_type</span><span class="w">    </span><span class="p">:</span><span class="w">   </span><span class="s">&#39;FLOAT&#39;</span><span class="w">              
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">|</span><span class="w">   </span><span class="s">&#39;INT&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">;</span><span class="w">          
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">any_type</span><span class="w">    </span><span class="p">:</span><span class="w">   </span><span class="nv">var_type</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">|</span><span class="w">   </span><span class="s">&#39;VOID&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">id_list</span><span class="w">     </span><span class="p">:</span><span class="w">   </span><span class="nv">id</span><span class="w"> </span><span class="nv">id_tail</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">id_tail</span><span class="w">     </span><span class="p">:</span><span class="w">   </span><span class="s">&#39;,&#39;</span><span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="nv">id_tail</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">|</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">...</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œå£°æ˜å˜é‡å¯¹åº”çš„æ˜¯ <code>var_decl</code> è§„åˆ™ï¼Œä¸€æ¬¡å¯ä»¥å£°æ˜ä¸€è‡³å¤šä¸ªå˜é‡ï¼Œæ¯ä¸€ä¸ªå˜é‡ä¹‹é—´ç”¨ <code>,</code> éš”å¼€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨è¿™æ¡è§„åˆ™çš„æœ«å°¾æœ€åæ³¨å…¥å¦‚ä¸‹çš„åŠ¨ä½œä»£ç ã€‚</p>
<blockquote>
<p>âš ï¸è¦æ³¨æ„å¦‚æœä½ ä¹Ÿæ˜¯ä½¿ç”¨ python çš„è¯ï¼Œè¿™é‡Œæ‰€ä»¥ç¼©è¿›ä¼šæœ‰ç‚¹æ€ªï¼Œå› ä¸ºæ¯ä¸€è¡Œéƒ½è¦ä»æœ€å·¦è¾¹å¼€å§‹ï¼Œä½†æœ€åç”Ÿæˆçš„ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="err">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">var_decl</span><span class="w">    </span><span class="p">:</span><span class="w">   </span><span class="nv">var_type</span><span class="w"> </span><span class="nv">id_list</span><span class="w"> </span><span class="s">&#39;;&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x"># NOTE: the indentation is correct, ANLTR4 will handle this for us :)
</span></span></span><span class="line"><span class="cl"><span class="x"># for all variable declarations, we should output the name &amp;&amp; type
</span></span></span><span class="line"><span class="cl"><span class="x"># in the same variable declaration, it means all of the variables have the same type
</span></span></span><span class="line"><span class="cl"><span class="x">for variable in </span><span class="nv">$id</span><span class="x">_list.text.split(&#39;,&#39;):
</span></span></span><span class="line"><span class="cl"><span class="x">    self.lookup(variable, None)
</span></span></span><span class="line"><span class="cl"><span class="x">    self.output_list.append(f&#34;name {variable} type {$var_type.text}&#34;)
</span></span></span><span class="line"><span class="cl"><span class="x">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">...</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ç”¨ <code>$id_list.text</code> æ¥è·å–æœ¬æ¥çš„å˜é‡å£°æ˜å¯¹åº”çš„æ–‡æœ¬ï¼Œç”¨ <code>$var_type.text</code> æ¥è·å–å¯¹åº”çš„å˜é‡ç±»å‹</p>
<h3 id="å…³äºå˜é‡ä½œç”¨åŸŸçš„å¤„ç†" class="headerLink">
    <a href="#%e5%85%b3%e4%ba%8e%e5%8f%98%e9%87%8f%e4%bd%9c%e7%94%a8%e5%9f%9f%e7%9a%84%e5%a4%84%e7%90%86" class="header-mark"></a>å…³äºå˜é‡ä½œç”¨åŸŸçš„å¤„ç†</h3><p>ä¸‹é¢ä»¥ <code>program</code> è§„åˆ™ä¸ºä¾‹ï¼ˆå‡½æ•°å’Œä»£ç å—çš„ç±»ä¼¼ï¼‰ï¼Œ<code>progarm</code> è§„åˆ™æ˜¯ Micro è¯­æ³•çš„èµ·å§‹è§„åˆ™ï¼Œè§„å®šäº† Micro ç¨‹åºåº”è¯¥è¦æœ‰çš„å¤§æ¡†æ¶ï¼Œè§„åˆ™å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="nl">program</span><span class="w"> </span><span class="p">:</span><span class="w">   </span><span class="s">&#39;PROGRAM&#39;</span><span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="s">&#39;BEGIN&#39;</span><span class="w"> </span><span class="nv">pgm_body</span><span class="w"> </span><span class="s">&#39;END&#39;</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å¤„ç†å®Œ <code>PROGRAM</code> è¿™ä¸ª token ä¹‹åå°±å¯ä»¥åˆå§‹åŒ–ç¬¬ä¸€ä¸ªä½œç”¨åŸŸï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œæœ€åè¦å¤„ç†å®Œç¨‹åºå†é€€å‡ºè¿™ä¸ªå…¨å±€ä½œç”¨åŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå¿«æƒ³åˆ°åº”è¯¥æŠŠåŠ¨ä½œæ³¨å…¥åœ¨å“ªé‡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="nl">program</span><span class="w"> </span><span class="p">:</span><span class="w">   </span><span class="s">&#39;PROGRAM&#39;</span><span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="s">&#39;BEGIN&#39;</span><span class="w"> </span><span class="nv">pgm_body</span><span class="w"> </span><span class="s">&#39;END&#39;</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="err">^</span><span class="w">                         </span><span class="err">^</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="err">|</span><span class="w">                         </span><span class="err">2</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åæ’å…¥ç›¸å…³çš„åŠ¨ä½œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="nl">program</span><span class="w"> </span><span class="p">:</span><span class="w">   </span><span class="s">&#39;PROGRAM&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">self.init()
</span></span></span><span class="line"><span class="cl"><span class="x">self.output_list.append(&#34;Symbol table GLOBAL&#34;)
</span></span></span><span class="line"><span class="cl"><span class="x">self.enter_new_scope()
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="p">}</span><span class="w">   </span><span class="nv">id</span><span class="w"> </span><span class="s">&#39;BEGIN&#39;</span><span class="w"> </span><span class="nv">pgm_body</span><span class="w"> </span><span class="s">&#39;END&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">self.exit_scope()
</span></span></span><span class="line"><span class="cl"><span class="x"># output everything after we parsing this program
</span></span></span><span class="line"><span class="cl"><span class="x">if self.declaration_error != &#39;&#39;:
</span></span></span><span class="line"><span class="cl"><span class="x">    print(self.declaration_error)
</span></span></span><span class="line"><span class="cl"><span class="x">else:
</span></span></span><span class="line"><span class="cl"><span class="x">    if len(self.warning_list) &gt; 0:
</span></span></span><span class="line"><span class="cl"><span class="x">        print(&#39;\n&#39;.join(self.warning_list))
</span></span></span><span class="line"><span class="cl"><span class="x">    print(&#39;\n&#39;.join(self.output_list))
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ‰©å±•é˜…è¯»" class="headerLink">
    <a href="#%e6%89%a9%e5%b1%95%e9%98%85%e8%af%bb" class="header-mark"></a>æ‰©å±•é˜…è¯»</h2><p>å‰é¢åªæ¶‰åŠåˆ°ç®€å•çš„åŠ¨ä½œæ³¨å…¥ï¼ŒANTLR4 å…¶å®æ”¯æŒçš„åŠŸèƒ½è¿˜æ›´å¤šï¼š</p>
<ul>
<li>æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è®© nonterminal è¿”å›å€¼</li>
<li>åœ¨åŒä¸€æ¡è§„åˆ™å¦‚æœå‡ºç°å¤šä¸ªåŒåçš„ nonterminal çš„è¯å¯ä»¥èµ·åå­—</li>
</ul>
<p>ä¸‹é¢æ˜¯æ¥è‡ªä¹¦ä¸­çš„ä¸€ä¸ªä¾‹å­ï¼Œå°±å¾ˆå¥½åœ°å±•ç¤ºäº†ä¸Šé¢ä¸¤ä¸ªç”¨æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-antlr" data-lang="antlr"><span class="line"><span class="cl"><span class="nl">e</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">[</span><span class="x">int v</span><span class="p">]</span><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="nv">a</span><span class="o">=</span><span class="nv">e</span><span class="w"> </span><span class="nv">op</span><span class="o">=(</span><span class="s">&#39;*&#39;</span><span class="o">|</span><span class="s">&#39;/&#39;</span><span class="o">)</span><span class="w"> </span><span class="nv">b</span><span class="o">=</span><span class="nv">e</span><span class="w">  </span><span class="p">{</span><span class="nv">$v</span><span class="x"> = self.eval(</span><span class="nv">$a</span><span class="p">.</span><span class="x">v, </span><span class="nv">$op</span><span class="x">, </span><span class="nv">$b</span><span class="p">.</span><span class="x">v)</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nv">a</span><span class="o">=</span><span class="nv">e</span><span class="w"> </span><span class="nv">op</span><span class="o">=(</span><span class="s">&#39;+&#39;</span><span class="o">|</span><span class="s">&#39;-&#39;</span><span class="o">)</span><span class="w"> </span><span class="nv">b</span><span class="o">=</span><span class="nv">e</span><span class="w">  </span><span class="p">{</span><span class="nv">$v</span><span class="x"> = self.eval(</span><span class="nv">$a</span><span class="p">.</span><span class="x">v, </span><span class="nv">$op</span><span class="x">, </span><span class="nv">$b</span><span class="p">.</span><span class="x">v)</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="no">INT</span><span class="w">                   </span><span class="p">{</span><span class="nv">$v</span><span class="x"> = </span><span class="nv">$INT</span><span class="p">.</span><span class="x">int</span><span class="p">}</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="no">ID</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ€»ç»“" class="headerLink">
    <a href="#%e6%80%bb%e7%bb%93" class="header-mark"></a>æ€»ç»“</h2><p>ä»è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°è¦å¦‚ä½•åœ¨ ANTLR4 é‡Œé¢ä½¿ç”¨åŠ¨ä½œï¼Œç”Ÿæˆ symbol table åªæ˜¯å…¶ä¸­ä¸€ä¸ªè¿ç”¨ã€‚åœ¨ä»£ç é‡Œé¢æ³¨å…¥åŠ¨ä½œæ˜¯å¾ˆç¬¦åˆç›´è§‰çš„åšæ³•ï¼Œå¯ä»¥å¿«é€Ÿå®ç°è‡ªå·±æƒ³è¦çš„åŠŸèƒ½ã€‚ä¸è¿‡ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå®ƒæ˜¯ language-dependent çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¸€æ—¦æ¢äº† ANTLR è¾“å‡ºçš„ç›®æ ‡è¯­è¨€ï¼Œä½ æ³¨å…¥çš„åŠ¨ä½œå…¨éƒ¨è¦æ”¹æˆæ–°çš„ç›®æ ‡è¯­è¨€ã€‚å¦å¤–å°±æ˜¯ä¼šè®©æœ¬æ¥å¹²å‡€çš„è¯­æ³•æ–‡ä»¶ä¸€å›¢ç³Ÿã€‚</p>
<h2 id="å‚è€ƒ" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83" class="header-mark"></a>å‚è€ƒ</h2><ol>
<li><a href="https://en.wikipedia.org/wiki/Symbol_table" target="_blank" rel="noopener noreferrer">Symbol table - wiki</a></li>
<li>ã€ŠANTLR4 æƒå¨æŒ‡å—ã€‹</li>
</ol>
</div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2022-05-28</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share"><button title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" data-title="How to use the semantic actions to generate the symbol tables in ANTLR4" data-hashtags="Compiler,Course"><span class="fab fa-twitter fa-fw"></span></button><button title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" data-hashtag="Compiler"><span class="fab fa-facebook-square fa-fw"></span></button><button title="åˆ†äº«åˆ° Hacker News" data-sharer="hackernews" data-url="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" data-title="How to use the semantic actions to generate the symbol tables in ANTLR4"><span class="fab fa-hacker-news fa-fw"></span></button><button title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" data-title="How to use the semantic actions to generate the symbol tables in ANTLR4"><span data-svg-src="/lib/simple-icons/icons/line.min.svg"></span></button><button title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" data-title="How to use the semantic actions to generate the symbol tables in ANTLR4"><span class="fab fa-weibo fa-fw"></span></button><button title="åˆ†äº«åˆ° Telegram" data-sharer="telegram" data-url="https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/" data-title="How to use the semantic actions to generate the symbol tables in ANTLR4" data-web><span class="fab fa-telegram-plane fa-fw"></span></button><script>
        function shareOnMastodon(title, link) {
            const SHARE_MASTODON_DOMAIN = "share_mastodon_domain"
            const savedDomain = localStorage.getItem(SHARE_MASTODON_DOMAIN) ?? "mastodon.social";
            const domain = prompt("Enter your Mastodon domain", savedDomain);
            if (domain === null) {
                return;
            }
            localStorage.setItem(SHARE_MASTODON_DOMAIN, domain)
            const text = title + "\n\n" + link;
            const url = new URL("https://" + domain)
            url.pathname = "share"
            url.searchParams.append('text', text)
            window.open(url, '_blank', "width=500,height=500,left=500,toolbar=0,status=0");
        }
    </script>
    <button title="åˆ†äº«åˆ° Mastodon"onclick="javascript:shareOnMastodon(&#34;How to use the semantic actions to generate the symbol tables in ANTLR4&#34;, &#34;https://martinlwx.github.io/zh-cn/how-to-use-antlr4-to-make-semantic-actions/&#34;)"><span class="fab fa-mastodon fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/zh-cn/tags/compiler/">Compiler</a>,&nbsp;<a href="/zh-cn/tags/course/">Course</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/zh-cn/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/zh-cn/boyer-moore-majority-voting-algorithm-explained/" class="prev" rel="prev" title="æ‘©å°”æŠ•ç¥¨æ³•"><i class="fas fa-angle-left fa-fw"></i>æ‘©å°”æŠ•ç¥¨æ³•</a>
            <a href="/zh-cn/vim-macro-101/" class="next" rel="next" title="Vim Macro 101">Vim Macro 101<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="giscus"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app/">giscus</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.126.1">Hugo</a> å¼ºåŠ›é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜ - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/MartinLwx" target="_blank" rel="noopener noreferrer">MartinLwx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":25},"comment":{"giscus":{"darkTheme":"dark","dataCategory":"Announcements","dataCategoryId":"DIC_kwDOGfB5nc4Ccjd0","dataEmitMetadata":"0","dataInputPosition":"bottom","dataLang":"en","dataLoading":"lazy","dataMapping":"pathname","dataReactionsEnabled":"1","dataRepo":"MartinLwx/martinlwx.github.io","dataRepoId":"R_kgDOGfB5nQ","dataStrict":"0","lightTheme":"preferred_color_scheme"}},"data":{"desktop-header-typeit":"MartinLwx's blog","mobile-header-typeit":"MartinLwx's blog"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"O4EMEES3VS","algoliaIndex":"index.zh-cn","algoliaSearchKey":"36fdaa364fae083332d0c8709026bd62","highlightTag":"em","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":30,"type":"algolia"},"sharerjs":true,"table":{"sort":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script><script type="text/javascript" src="/js/giscus.min.js" defer></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-7RY6742J2F', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-7RY6742J2F" async></script></div>
</body>

</html>
